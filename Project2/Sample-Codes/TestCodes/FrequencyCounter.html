<!DOCTYPE html>
<html lang="en">
	<head>
		<title> Word Frequency Counter </title>
		<script type="text/javascript" src="https://d3js.org/d3.v3.min.js"> </script>
		<script src="https://d3js.org/d3-dsv.v1.min.js"></script>
	</head>
	<body>

		<script type="text/javascript">

			// Initializing Global Variables to be used in the program
			var allData;
			// allLocation Format : {nameOfLocation: total frequency}, similar for allPersons, allOrganization and allMiss
			var allLocations = new Map();
			var allPersons = new Map();
			var allOrganization = new Map();
			var allMiss	= new Map();





			var locationValues =[];

			

			var date;
			var location;
			var people;
			var category;
			var missc;
			var parseLocation;

			
			//Initializing time and date parsers for handling date.
			parseDate = d3.time.format("%Y-%m").parse;
			formatDate = d3.time.format("%b-%Y");

			
			

			

			

			//Loading the wikinews data file and processing it
			d3.tsv("../Data/wikinews.tsv", function(error,data)
			{
				allData = data
				if (error) throw error;

				data.forEach(function(d){

					
					processName(d);
					processLocation(d);
					processOrganization(d);
					processMiss(d);

					

					

				})

			}) // end of d3.tsv



			//function for processing all locations
			function processLocation(d)
			{

				parseLocation = d.location.replace("\"","").split("|");

				parseLocation.forEach(function(eachLocation)
				{

					var count = getMapValue(allLocations,eachLocation)

					if (count === undefined)
					{
						allLocations[eachLocation] = 1
						
					}
					else
					{
						allLocations[eachLocation] = count + 1
					}



				})
			}


			function processName(d)
			{
				parseName = d.person.replace("\"","").split("|");

				parseName.forEach(function(eachPerson){

					var count = getMapValue(allPersons,eachPerson)

					if (count === undefined)
					{
						allPersons[eachPerson] = 1
							
					}
					else
					{
						allPersons[eachPerson] = count + 1
					}

				})
			}


			function processOrganization(d)
			{

				parseOrganization = d.organization.replace("\"","").split("|");

				parseOrganization.forEach(function(eachOrganization)
				{

					var count = getMapValue(allOrganization,eachOrganization)

					if (count === undefined)
					{
						allOrganization[eachOrganization] = 1
							
					}
					else
					{
						allOrganization[eachOrganization] = count + 1
					}

				})
			}


			function processMiss(d)
			{
				parseMiss = d.miscellaneous.replace("\"","").split("|");

				parseMiss.forEach(function(eachMiss)
				{

					var count = getMapValue(allMiss,eachMiss)

					if (count === undefined)
					{
						allMiss[eachMiss] = 1
							
					}
					else
					{
						allMiss[eachMiss] = count + 1
					}

				})



			}



				

				

				


			




			function getMapValue(theMap,theValue)
			{			
				
				return theMap[theValue];


			}



			
			

			





		</script>
	</body>
</html>